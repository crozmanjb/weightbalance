<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>USU Weather</title>
	<style>
		html {
			height: 100%;
		}
		
		body {
			font-size: 40px;
			width: 100%;
			height: 100%;
		}
		
		
		#content {
			width: 100%;
			height: 100%;
			display: flex;
			flex-direction: column;
			justify-content: center;
			text-align: center;
			
		}
		
		#temp, #time {
			display: inline;
		}
	</style>
	<script language="javascript">
		var weatherData;
		var getJSON = function(url, callback) {

			var xhr = new XMLHttpRequest();
			xhr.open('GET', url, true);
			xhr.responseType = 'json';

			xhr.onload = function() {

				var status = xhr.status;

				if (status == 200) {
					callback(null, xhr.response);
				} else {
					callback(status);
				}
			};

			xhr.send();
		};

		getJSON('https://campusweather1.uwrl.usu.edu/Charts/Get-HC-main.php?chart=76&units=US',  function(err, data) {

			if (err != null) {
				console.error(err);
			} else {
				var temp = Math.round(data.series[5].data[data.series[5].data.length-1][1] * 10) / 10;
				var now = new Date();
				var time = new Date(data.series[5].data[data.series[5].data.length-1][0]);
				var diff = Math.round((now - time) / 1000 / 60);
				document.getElementById("temp").innerHTML = temp + " ÂºF";
				document.getElementById("time").innerHTML = diff + " mins ago";
				console.info(data);
				console.info(data.series[5].data[data.series[5].data.length-1]);
				
			}
		});
		
	</script>
</head>
<body>
	<div id="content">
		<div>The temperature was 
			<div id="temp">ERR</div> on campus 
			<div id="time">ERR</div>
			</div>
		</div>
</body>
</html>
